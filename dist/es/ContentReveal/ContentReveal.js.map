{"version":3,"file":"ContentReveal.js","sources":["../../../src/ContentReveal/ContentReveal.js"],"sourcesContent":["import React from 'react'\nimport { useIsomorphicLayoutEffect } from 'react-use'\nimport { gsap } from 'gsap'\nimport { ExpoScaleEase } from 'gsap/EasePack'\nimport { ScrollTrigger } from 'gsap/ScrollTrigger'\nimport styled from 'styled-components'\n\nimport { match } from '../_contexts/Theme'\nimport useInstance from '../_hooks/useInstance'\n\ngsap.registerPlugin(ScrollTrigger)\ngsap.registerPlugin(ExpoScaleEase)\n\nconst ContentReveal = (props) => {\n  const { background, reveal } = props\n\n  const stickyContainerRef = React.useRef()\n  const revealMaskRef = React.useRef()\n  const revealMaskInnerRef = React.useRef()\n  const revealRef = React.useRef()\n  const timeline = useInstance(() => gsap.timeline())\n\n  useIsomorphicLayoutEffect(() => {\n    const animationRefs = {\n      revealMaskRef,\n      revealMaskInnerRef,\n      revealRef,\n      timeline,\n    }\n    buildAnimation(animationRefs)\n\n    ScrollTrigger.create({\n      trigger: stickyContainerRef.current,\n      scrub: true,\n      start: 'top top',\n      end: 'bottom bottom',\n      animation: timeline,\n      ease: 'none',\n    })\n  }, [timeline])\n\n  return (\n    <StickyContainer ref={stickyContainerRef}>\n      <StickyItem>\n        <ContentContainer>{background}</ContentContainer>\n        <RevealContainer>\n          <RevealMask ref={revealMaskRef}>\n            <RevealMaskInner ref={revealMaskInnerRef}>\n              <Reveal ref={revealRef}>{reveal}</Reveal>\n            </RevealMaskInner>\n          </RevealMask>\n        </RevealContainer>\n      </StickyItem>\n    </StickyContainer>\n  )\n}\n\nconst buildAnimation = ({\n  revealMaskRef,\n  revealMaskInnerRef,\n  revealRef,\n  timeline,\n}) => {\n  const progress = timeline.progress()\n\n  timeline.pause(0).clear()\n  gsap.set([revealMaskRef.current, revealRef.current], {\n    clearProps: 'all',\n  })\n\n  const scaleFactor = 0.001\n\n  timeline.fromTo(\n    revealMaskRef.current,\n    {\n      scale: scaleFactor,\n    },\n    {\n      duration: 3,\n      scale: 1,\n      ease: ExpoScaleEase.config(scaleFactor, 1, 'power2.inOut'),\n    },\n    0\n  )\n\n  timeline.fromTo(\n    revealMaskInnerRef.current,\n    { scale: 1 / scaleFactor },\n    {\n      duration: 3,\n      scale: 1,\n      ease: ExpoScaleEase.config(1 / scaleFactor, 1, 'power2.inOut'),\n    },\n    0\n  )\n\n  timeline.progress(progress)\n}\n\nconst StickyContainer = styled.div`\n  position: relative;\n  height: 250vh;\n`\n\nconst StickyItem = styled.div`\n  position: sticky;\n  width: 100%;\n  height: 100vh;\n  top: 0;\n`\n\nconst ContentContainer = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100vh;\n  z-index: 1;\n`\n\nconst RevealContainer = styled.div`\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 100vh;\n  overflow: hidden;\n  z-index: 2;\n`\n\nconst RevealMask = styled.div`\n  border-radius: 50%;\n  overflow: hidden;\n  position: absolute;\n  top: 100%;\n  left: 100%;\n  transform: translate(-50%, -50%);\n\n  @media ${match.isPortrait} {\n    width: 260vh;\n    height: 260vh;\n  }\n  @media ${match.isLandscape} {\n    width: 260vw;\n    height: 260vw;\n  }\n`\n\nconst RevealMaskInner = styled.div`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n`\n\nconst Reveal = styled.div`\n  height: 100vh;\n  width: 100vw;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-100%, -100%);\n  transform-origin: bottom right;\n`\nexport default ContentReveal\n"],"names":["gsap","registerPlugin","ScrollTrigger","ExpoScaleEase","ContentReveal","props","background","reveal","stickyContainerRef","React","useRef","revealMaskRef","revealMaskInnerRef","revealRef","timeline","useInstance","useIsomorphicLayoutEffect","animationRefs","buildAnimation","create","trigger","current","scrub","start","end","animation","ease","progress","pause","clear","set","clearProps","scaleFactor","fromTo","scale","duration","config","StickyContainer","styled","div","StickyItem","ContentContainer","RevealContainer","RevealMask","match","isPortrait","isLandscape","RevealMaskInner","Reveal"],"mappings":"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"}